## 实验3
**每阶段的内容储存在Section{number}文件夹下**

基本需求：利用用户购物数据集，分析预测回头客。涉及数据预处理、存储、查询、排序、统计分析等数据处理全流程所涉及的各种典型应用场景，涵盖Hadoop、MapReduce、Spark、Hive、HBase等系统和软件的安装和使用方法。培养MapReduce和Spark的编程能力，并尝试应用机器学习算法进行大数据挖掘。实验将分阶段完成。


完整数据集：淘宝用户购物数据集（半年内，包含双11）https://pan.baidu.com/s/1cs02Nc

用户行为日志文件 user_log.csv (3000万条)
回头客训练集 train.csv
回头客测试集 test.csv
数据格式说明：

用户行为日志user_log.csv，日志中的字段定义如下：

user_id | 买家id
item_id | 商品id
cat_id | 商品类别id
merchant_id | 卖家id
brand_id | 品牌id
month | 交易时间:月
day | 交易事件:日
action | 行为,取值范围{0,1,2,3},0表示点击，1表示加入购物车，2表示购买，3表示关注商品
age_range | 买家年龄分段：1表示年龄<18,2表示年龄在[18,24]，3表示年龄在[25,29]，4表示年龄在[30,34]，5表示年龄在[35,39]，6表示年龄在[40,49]，7和8表示年龄>=50，0和NULL则表示未知
gender | 性别:0表示女性，1表示男性，2和NULL表示未知
province | 收货地址省份
回头客训练集train.csv和回头客测试集test.csv，训练集和测试集拥有相同的字段，字段定义如下：

user_id | 买家id 
age_range | 买家年龄分段：1表示年龄<18,2表示年龄在[18,24]，3表示年龄在[25,29]，4表示年龄在[30,34]，5表示年龄在[35,39]，6表示年龄在[40,49]，7和8表示年龄>=50，0和NULL则表示未知 
gender | 性别:0表示女性，1表示男性，2和NULL表示未知 
merchant_id | 商家id 
label | 是否是回头客，0值表示不是回头客，1值表示回头客，-1值表示该用户已经超出我们所需要考虑的预测范围。NULL值只存在测试集，在测试集中表示需要预测的值。


实验环境：

Linux/CentOS/macOS
Java 1.8+
Hadoop 3.2.x （安装模式：单节点伪分布式/集群模式）
Spark 2.4.x （安装模式：Standalone/集群模式）
Hive 3.1.x
HBase 2.2.x


阶段一任务（MapReduce）：

精简数据集：淘宝双十一用户购物数据集（100万条），见附件 million_user_log.csv.zip
基于精简数据集完成MapReduce作业：
统计各省的双十一前十热门关注产品（“点击+添加购物车+购买+关注”总量最多前10的产品）
统计各省的双十一前十热门销售产品（购买最多前10的产品）

阶段二任务（Hive）：

Hive操作

- 把精简数据集导入到数据仓库Hive中，并对数据仓库Hive中的数据进行查询分析
- 查询双11那天有多少人购买了商品
- 查询双11那天男女买家购买商品的比例
- 查询双11那天浏览次数前十的品牌